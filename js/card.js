"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,n){if(t){if("string"==typeof t)return _arrayLikeToArray(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,n):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var cardSection=document.querySelector(".card"),cardDescription=document.querySelector(".card__description"),recommendationsSection=document.querySelector(".recommendations"),URLmain="http://localhost:3000/api/goods",cardRender=function(t){console.log(t);var n=document.createElement("h2");n.classList.add("card__name"),n.innerText=t.title;var e=document.createElement("div");e.classList.add("card__wrapper");var r=t.price,a=0;t.discount&&(a=t.discount,r=Math.round(r+r/100*a)),e.insertAdjacentHTML("afterbegin",'<div class="card__img">\n                     <img loading="lazy" src= http://localhost:3000/'.concat(t.image,' alt="Картинка товара" width="540" height="303">   \n                </div>\n                <div class="card__basket-wrapper">\n                    <div class="card__prices">\n                        <span class="new-price">').concat(t.price,' ₽</span>\n                        <span class="old-price">').concat(r,' ₽</span>\n                    </div>\n                    <a href="#" class="card__credit-link">В кредит от 5600 ₽</a>\n                    <div class="card__buttons-wrapper">\n                        <button class="card__btn-basket">Добавить в корзину</button>\n                        <button class="card__btn-favourites"><img src="img/icon-favourites.svg" alt=""></button>   \n                    </div>\n                    <div class="card__info-wrapper">\n                        <div class="card__info-item">\n                            <span>Доставка</span>\n                            <span class="card__info-date">1-3 января</span>\n                        </div> \n                        <div class="card__info-item">\n                            <span>Продавец</span>\n                            <span class="card__info-seller">ShopOnline</span>\n                        </div> \n                    </div>\n                    <a href="#" class="card__bell-link"><img src="img/icon-bell.svg" alt="">Узнать о снижении цены</a>\n                </div>')),t.discount&&(e.querySelector(".card__img").classList.add("card__img-discount"),e.querySelector(".card__img").dataset.text="".concat(t.discount,"%")),e.querySelector(".card__btn-basket").addEventListener("click",(function(n){var e=JSON.parse(localStorage.getItem("basket"))||[],a=t.title,c=t.price,i=r,o=t.image,s=1,d=_toConsumableArray(e);e.length&&e!==[]&&e.map((function(t,n){t.titleProduct==a&&(s=t.countProduct,d.splice(d.findIndex((function(t){return"titleProduct"===t.field})),1),s++)}));var l={titleProduct:a,imageProduct:o,newpriceProduct:c,oldriceProduct:i,countProduct:s};localStorage.setItem("basket",JSON.stringify([].concat(_toConsumableArray(d),[l])))}));var c=document.createElement("p");return c.classList.add("card__description-text"),c.innerText=t.description,cartFull={title:n,cardWrapper:e,cardText:c}},init=function(){fetch(URLmain).then((function(t){return t.json()})).then((function(t){return t[Math.floor(Math.random()*t.length)]})).then((function(t){return cardRender(t)})).then((function(t){return cardSection.prepend(t.title,t.cardWrapper)&cardDescription.append(t.cardText)})).catch((function(t){console.log(t)}))};init();var cardsRenderRecom=function(t){if(t){var n=document.createElement("ul");return n.classList.add("sale__list"),t.forEach((function(e,r){var a=document.createElement("li");a.classList.add("sale__item","sale__item_".concat(r+1));var c=t[r].price,i=0;t[r].discount&&(i=t[r].discount,c=Math.round(c+c/100*i),a.classList.add("sale__item-discount"),a.dataset.text="".concat(t[r].discount,"%")),a.insertAdjacentHTML("afterbegin",'\n                <img loading="lazy" src= http://localhost:3000/'.concat(e.image,' alt="Картинка скидок" class="stock__img" width="325" height="295">\n                <div class="sale__wrapper-prices">\n                    <span class="price-sale">').concat(t[r].price,' ₽</span>\n                    <span class="price-full">').concat(c,' ₽</span>\n                </div>\n                <p class="sale__description">').concat(t[r].title,"</p>")),n.appendChild(a)})),n}},initRecommendation=function(){fetch(URLmain).then((function(t){return t.json()})).then((function(t){return t.slice(0,8)})).then((function(t){return cardsRenderRecom(t)})).then((function(t){return recommendationsSection.append(t)})).catch((function(t){console.log(t)}))};initRecommendation();
//# sourceMappingURL=../maps/card.js.map
