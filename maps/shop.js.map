{"version":3,"sources":["shop.js"],"names":["recommendationsSection","document","querySelector","URLmain","basketWrapper","deliveryInfo","basketResultPriceNew","basketResultCount","basketResultPrice","basketResultDiscount","btnBasketDel","basketCheckboxAll","cardsRenderRecom","data","listWrapper","createElement","classList","add","forEach","item","index","li","concat","oldPrice","price","discount","Math","round","dataset","text","insertAdjacentHTML","image","title","appendChild","initRecommendation","fetch","then","response","json","slice","items","cards","append","err","console","log","ChangingQuantityGoods","initBasket","titleProductChange","signProduct","basketStorage","JSON","parse","localStorage","getItem","map","titleProduct","countProduct","setItem","stringify","remove","innerHTML","resultCountProducts","resultPriceProducts","resultPriceProductsOld","basketDiv","newpriceProduct","oldriceProduct","basketItem","imageProduct","imgDelivery","src","querySelectorAll","addEventListener","e","preventDefault","titleTarget","target","closest","innerText","contains","basketEmpty","style","color","fontSize","checked","removeItem"],"mappings":"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","file":"../js/shop.js","sourcesContent":["\r\nconst recommendationsSection = document.querySelector('.recommendations');\r\nconst URLmain = 'http://localhost:3000/api/goods';\r\nconst basketWrapper = document.querySelector('.basket__products');\r\nconst deliveryInfo = document.querySelector('.delivery-info__img');\r\nconst basketResultPriceNew = document.querySelector('.basket__result-price-new');\r\nconst basketResultCount = document.querySelector('.basket__result-count');\r\nconst basketResultPrice = document.querySelector('.basket__result-price');\r\nconst basketResultDiscount = document.querySelector('.basket__result-discount');\r\nconst btnBasketDel = document.querySelector('.btn-basket-del');\r\nconst basketCheckboxAll = document.querySelector('.basket__checkbox-all');\r\n\r\n\r\n// Функция рендера карточек для секции Рекомендуемые\r\nconst cardsRenderRecom = (data) => {\r\n    if(data) {\r\n       const listWrapper  = document.createElement('ul');\r\n       listWrapper.classList.add('sale__list');\r\n        \r\n        data.forEach((item, index) => {  \r\n          const li  = document.createElement('li');\r\n          li.classList.add('sale__item', `sale__item_${index+1}`);\r\n\r\n            let oldPrice = data[index].price;\r\n            let discount = 0;\r\n            if (data[index].discount) {\r\n                discount = data[index].discount;\r\n                oldPrice = Math.round(oldPrice + (oldPrice/100*discount));\r\n                li.classList.add('sale__item-discount');\r\n                li.dataset.text = `${data[index].discount}%`;\r\n              }   \r\n\r\n            li.insertAdjacentHTML('afterbegin',`\r\n                <img loading=\"lazy\" src= http://localhost:3000/${item.image} alt=\"Картинка скидок\" class=\"stock__img\" width=\"325\" height=\"295\">\r\n                <div class=\"sale__wrapper-prices\">\r\n                    <span class=\"price-sale\">${data[index].price} ₽</span>\r\n                    <span class=\"price-full\">${oldPrice} ₽</span>\r\n                </div>\r\n                <p class=\"sale__description\">${data[index].title}</p>`\r\n            );\r\n            listWrapper.appendChild(li);\r\n           \r\n        });\r\n        return listWrapper\r\n    }\r\n}\r\n\r\n// Загрузка блока рекомендаций при загрузке\r\nconst initRecommendation = () => {\r\n    fetch(URLmain)\r\n    .then((response) => response.json())\r\n    .then((data) => data.slice(0, 8))\r\n    .then((items) => cardsRenderRecom(items))\r\n    .then((cards) => recommendationsSection.append(cards))\r\n    .catch((err) => {\r\n        console.log(err)\r\n    })\r\n}\r\n    initRecommendation()\r\n\r\n\r\n    // Функци изменения количества товара при нажатии на кнопки\r\n    const ChangingQuantityGoods = () => {\r\n\r\n    }\r\n\r\n    // Загрузка блока корзины товаров\r\n    const initBasket = (titleProductChange, signProduct) => {\r\n        let basketStorage = JSON.parse(localStorage.getItem('basket')) || null;\r\n        if (basketStorage && basketStorage !== null) {\r\n            if (titleProductChange && signProduct) {\r\n                basketStorage.map((item) => {\r\n                    if (item.titleProduct == titleProductChange){\r\n                        if(signProduct == 'Plus') {\r\n                            item.countProduct++;\r\n                        }\r\n                        if(signProduct == 'Minus') {\r\n                            item.countProduct--;\r\n                        }       \r\n                    }\r\n                })\r\n                localStorage.setItem('basket', JSON.stringify(basketStorage));\r\n                basketWrapper.querySelector('.basket__products-items').remove();\r\n                deliveryInfo.innerHTML = '';\r\n            }\r\n\r\n            let resultCountProducts = 0;\r\n            let resultPriceProducts = 0;\r\n            let resultPriceProductsOld = 0;\r\n\r\n            const basketDiv  = document.createElement('div');\r\n            basketDiv.classList.add('basket__products-items');\r\n\r\n            basketStorage.forEach((item, index) => {\r\n                resultCountProducts += item.countProduct;\r\n                resultPriceProducts += (item.countProduct*item.newpriceProduct);\r\n                resultPriceProductsOld += (item.countProduct*item.oldriceProduct);\r\n\r\n                const basketItem  = document.createElement('div');\r\n                basketItem.classList.add('basket__products-item');\r\n                basketItem.insertAdjacentHTML('afterbegin',`\r\n                    <input type=\"checkbox\" name=\"basket\" value=\"select item\">\r\n                    <img src= http://localhost:3000/${item.imageProduct} alt=\"Картинака товара ${index}\">\r\n                    <div class=\"products-items__info\">\r\n                        <h3 class=\"product-title\">${item.titleProduct}</h3>\r\n                        <p>Цвет: черный</p>\r\n                        <p>Оперативная память: 16 ГБ</p>\r\n                    </div>\r\n                    <div class=\"products-item__count\">\r\n                        <button class=\"btn-subtract\"></button>\r\n                        <span class=\"quantity-goods\">${item.countProduct}</span>\r\n                        <button class=\"btn-increase\"></button>\r\n                    </div>\r\n                    <div class=\"products-item__price\">\r\n                        <span class=\"basket__new-price\">${item.newpriceProduct} ₽</span>\r\n                        <span class=\"basket__old-price\">${item.oldriceProduct} ₽</span>\r\n                        <a href=\"#\" class=\"basket__credit\">В кредит от <span>5600 ₽</span></a>\r\n                    </div>`\r\n                );\r\n                basketDiv.appendChild(basketItem);\r\n\r\n                const imgDelivery  = document.createElement('img');\r\n                imgDelivery.src = `http://localhost:3000/${item.imageProduct}`;\r\n                deliveryInfo.appendChild(imgDelivery);\r\n            })\r\n\r\n            basketWrapper.appendChild(basketDiv)\r\n\r\n            //функции при нажатии на кнопки прибавить или уменьшить количество товара\r\n            basketWrapper.querySelectorAll('.products-item__count').forEach(item => {\r\n                item.addEventListener('click', (e) => {\r\n                    e.preventDefault()\r\n                    const titleTarget = e.target.closest('.basket__products-item').querySelector('.product-title').innerText;\r\n                  if (e.target.classList.contains('btn-subtract') || e.target.closest('btn-subtract'))  {\r\n                    if (e.target.closest('.basket__products-item').querySelector('.quantity-goods').innerText < 2) {\r\n                        return\r\n                    }\r\n                    else{\r\n                        initBasket(titleTarget, 'Minus')\r\n                    }\r\n                  }\r\n                  if (e.target.classList.contains('btn-increase') || e.target.closest('btn-increase'))  {\r\n                    initBasket(titleTarget, 'Plus')\r\n                  }\r\n                })\r\n            })\r\n\r\n            basketResultCount.innerText = `Товары, ${resultCountProducts}  шт.`;\r\n            basketResultPriceNew.innerText = `${resultPriceProducts} ₽`;\r\n            basketResultPrice.innerText = `${resultPriceProductsOld} ₽`;\r\n            basketResultDiscount.innerText = resultPriceProductsOld - resultPriceProducts;\r\n         }\r\n         else {\r\n            const basketEmpty  = document.createElement('p');\r\n            basketEmpty.style.color = 'black';\r\n            basketEmpty.style.fontSize = \"50px\";\r\n            basketEmpty.innerText = 'Корзина пуста';\r\n            basketWrapper.append(basketEmpty);\r\n\r\n            basketResultCount.innerText = 'Товары, 0  шт.'\r\n            basketResultPrice.innerText = '0 ₽'\r\n            basketResultPriceNew.innerText = '0 ₽';\r\n            basketResultDiscount.innerText = '0 ₽';\r\n         }\r\n    }\r\n    initBasket(null, null);\r\n    \r\n    // Нажатие на кноку удалить всё из корзины\r\n    btnBasketDel.addEventListener('click', e => {\r\n        e.preventDefault()\r\n        if (basketWrapper.querySelector('.basket__products-items') && basketCheckboxAll.checked) {\r\n            localStorage.removeItem('basket');\r\n            basketWrapper.querySelector('.basket__products-items').remove();\r\n            basketCheckboxAll.checked = false;\r\n            deliveryInfo.innerHTML = '';\r\n            initBasket(null, null);\r\n        }\r\n       \r\n    })"]}